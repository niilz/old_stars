(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[862],{154:e=>{e.exports={Header:"Header_Header__r28vo",logo:"Header_logo__ITeVo",headerStripes:"Header_headerStripes__uGMbu",title:"Header_title__llmgH"}},1002:e=>{e.exports={Message:"Message_Message__RY7Dc",error:"Message_error__oQdtH",info:"Message_info__ULI_R",none:"Message_none__9v8Rt"}},1490:e=>{e.exports={AppLogo:"Logo_AppLogo__n42AC",starotate:"Logo_starotate__yepxx"}},1540:e=>{e.exports={Btn:"Button_Btn__tQLCR"}},1634:e=>{e.exports={Main:"Main_Main__cpCi5",headerStripes:"Main_headerStripes__gOoXo",title:"Main_title__QDklA",logo:"Main_logo__1tkZI"}},1959:e=>{e.exports={RegisterLoginForm:"ClubLoginForm_RegisterLoginForm__SW6p7",registerBtn:"ClubLoginForm_registerBtn__wr2eO"}},2091:e=>{e.exports={warningWrapper:"WaterRoundWarning_warningWrapper__6Uygi",warning:"WaterRoundWarning_warning__S9NfG"}},2263:e=>{e.exports={User:"UserView_User__s0Lxk",statsPanel:"UserView_statsPanel__rvhge",icons:"UserView_icons__H88O8",stats:"UserView_stats__Mo182",beer:"UserView_beer__aBxz5",other:"UserView_other__i7pF5",cigarette:"UserView_cigarette__4r0YY"}},2564:e=>{e.exports={ArchiveView:"ArchiveView_ArchiveView__N04WG",ArchiveList:"ArchiveView_ArchiveList__uL8b6",archiveButton:"ArchiveView_archiveButton__4UX3Q"}},2711:e=>{e.exports={error:"GlobalError_error__xWTQ7"}},3774:e=>{e.exports={Main:"UserLoginView_Main__shzii",headerStripes:"UserLoginView_headerStripes__9quCT",title:"UserLoginView_title__nXRqF",logo:"UserLoginView_logo__EqOOa"}},3905:()=>{},3911:e=>{e.exports={UserList:"UserList_UserList__17M_W",TableArea:"UserList_TableArea__p4Va_",Thead:"UserList_Thead__taPn2",Tr:"UserList_Tr__sPT1_",Th:"UserList_Th__j3c13"}},4622:e=>{e.exports={Modal:"Modal_Modal__mpQgM"}},4840:e=>{e.exports={Playground:"Playground_Playground__RMDje",buttons:"Playground_buttons__gz5h9",refresh:"Playground_refresh__84xa1"}},4909:e=>{e.exports={RegisterLoginForm:"AdminLoginForm_RegisterLoginForm__kXDxJ",registerBtn:"AdminLoginForm_registerBtn__b2vPL"}},7014:e=>{e.exports={LoginForm:"Login_LoginForm__uHOu_"}},7737:e=>{e.exports={AdminConsole:"AdminConsole_AdminConsole__rASuW",DataSection:"AdminConsole_DataSection__jJAVQ",textarea:"AdminConsole_textarea__3k4W7"}},7768:e=>{e.exports={OneHistory:"OneHistoryView_OneHistory__N_vm3",H1:"OneHistoryView_H1__zX2JW",H2:"OneHistoryView_H2__yg_Nc"}},8976:e=>{e.exports={RegisterLoginForm:"RegisterLoginForm_RegisterLoginForm__fPouy",registerBtn:"RegisterLoginForm_registerBtn__xymoa"}},9231:e=>{e.exports={Main:"ClubLoginView_Main__1VfWF",headerStripes:"ClubLoginView_headerStripes__d05kc",title:"ClubLoginView_title__CiXdd",logo:"ClubLoginView_logo__GPgKF"}},9458:e=>{e.exports={itemContent:"ListItem_itemContent__c2Zb8",userData:"ListItem_userData__liP5I",delBtn:"ListItem_delBtn___70mM",count:"ListItem_count__0Khk_"}},9862:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AppCtx:()=>eW,default:()=>ez});var r=s(5155),n=s(2115);let o="old-star-user-session",a="oldstars-club-token";var i=function(e){return e.GET="GET",e.POST="POST",e.DELETE="DELETE",e.HEAD="HEAD",e.OPTIONS="OPTIONS",e}({});let l=new Headers;async function c(e,t,s,r){return u(e,t,s,o,r)}async function u(e,t,s,r,n){r&&n&&l.set(r,n);let o={method:e,headers:l,mode:"cors",cache:"default",credentials:"include"};e===i.POST&&(o.body=s);let a=await fetch(`https://niilz.de/${t}`,o);return await a.json()}function d(e){let{Ok:t}=e,{Err:s}=e;if(s)throw`Ooops... ${s}`;return t}async function g(e,t){return d(await u(i.POST,"register",JSON.stringify(e),a,t))}async function h(e,t){return c(i.GET,`user/${t}`,"",e)}async function m(e){return c(i.GET,"all","",e)}async function x(e){return c(i.GET,"start","",e)}async function _(e){return c(i.GET,"logout","",e)}l.set("Accept","application/json"),l.set("Content-Type","application/json");var y=s(1634),p=s.n(y),j=function(e){return e[e.ClubLogin=0]="ClubLogin",e[e.UserLogin=1]="UserLogin",e[e.AdminLogin=2]="AdminLogin",e[e.Playground=3]="Playground",e[e.AdminConsole=4]="AdminConsole",e[e.Histories=5]="Histories",e[e.OneHistory=6]="OneHistory",e}({});class C{tryReadFromStorage(e){let t=this.readFromStorage(e);if(!t)throw`No value for key ${e} present`;return t}}class L extends C{readFromStorage(e){return window.localStorage.getItem(e)}removeItem(e){window.localStorage.removeItem(e)}storeItem(e,t){window.localStorage.setItem(e,t)}}let w=n.createContext({keyValueStore:new L,setKeyValueStore:e=>{}}),v=n.createContext({addUser:e=>{},setSessionUser:e=>{}}),f=n.createContext({activeView:j.ClubLogin,setActiveView:e=>{}}),S=n.createContext({currentError:"",setCurrentError:e=>{}}),b=n.createContext({selectedHistory:[],setSelectedHistory:e=>{}});var N=s(1490),E=s.n(N);function D(e){return(0,r.jsx)("div",{className:`${E().AppLogo} ${e.styles}`,children:"⭐"})}var A=s(154),k=s.n(A);function T(e){let{appHeight:t}=(0,n.useContext)(eW);return(0,r.jsxs)("header",{className:k().Header,children:[e.showLogo?(0,r.jsx)(D,{styles:k().logo}):null,(0,r.jsx)("div",{className:`${k().headerStripes} ${e.styles?e.styles.headerStripes:""}`,children:(0,r.jsx)("h1",{className:`${k().title} ${e.styles?e.styles.title:""}`,children:"Old-Stars App"})})]})}var U=s(9231),F=s.n(U),R=s(1002),H=s.n(R),O=function(e){return e.ERR="error",e.INFO="info",e.NONE="none",e}({});function $(e){return(0,r.jsx)("p",{className:`${H().Message} ${H()[e.type]}`,children:e.msg})}class P{static async loginUser(e,t){return d(await u(i.POST,"login",JSON.stringify(e),a,t))}static async clubLogin(e){return d(await u(i.POST,"club/login",JSON.stringify({name:"club",pwd:e})))}static async hasClubAccess(e){return u(i.GET,"club/access","",a,e)}static async isAdmin(e){return c(i.GET,"admin","",e)}}var V=s(1540),B=s.n(V);function I(e){return(0,r.jsx)("button",{className:`${B().Btn} ${e.styles}`,onClick:e.callback,children:e.text})}var M=s(1959),G=s.n(M);function W(e){let t;return e?"object"!=typeof e?{msg:e.toString()}:("msg"in e&&(t=e.msg),"message"in e&&(t=e.message),t)?"string"==typeof t?{msg:t}:{msg:`unknwon message-type: ${e}`}:{msg:`unknown message-prop: ${e}`}:{msg:"error is null"}}function z(e){let[t,s]=(0,n.useState)(""),{keyValueStore:o}=(0,n.useContext)(w);return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("form",{onSubmit:J,className:`${G().RegisterLoginForm}`,children:[(0,r.jsx)("input",{type:"password",value:t,placeholder:"password",onChange:e=>s(e.target.value)}),(0,r.jsx)(I,{text:"Login",styles:G().registerBtn,callback:()=>{P.clubLogin(t).then(t=>{s(""),"string"==typeof t&&(o.storeItem(a,t),e.onLogin())}).catch(t=>{e.onError(O.ERR,W(t).msg)})}})]})})}function J(e){e.preventDefault()}function Q(){let{setActiveView:e}=(0,n.useContext)(f),[t,s]=(0,n.useState)(""),[o,a]=(0,n.useState)(O.NONE);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T,{showLogo:!1,styles:{headerStripes:F().headerStripes,title:F().title}}),(0,r.jsx)(D,{styles:F().logo}),(0,r.jsx)($,{msg:t,type:o}),(0,r.jsx)(z,{onLogin:()=>e(j.UserLogin),onError:(e,t)=>{s(t),a(e)}})]})}var X=s(8976),q=s.n(X);function K(e){let{setSessionUser:t}=(0,n.useContext)(v),{keyValueStore:s}=(0,n.useContext)(w),[i,l]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),d=async()=>{try{let t=s.tryReadFromStorage(a),r=await g({name:i,pwd:c},t);e.onRegister(r),l(""),u("")}catch(t){e.onError(O.ERR,W(t).msg)}};return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("form",{onSubmit:Y,className:`${q().RegisterLoginForm}`,children:[(0,r.jsx)("input",{type:"text",placeholder:"user-name",value:i,onChange:e=>l(e.target.value)}),(0,r.jsx)("input",{type:"password",value:c,placeholder:"password",onChange:e=>u(e.target.value)}),(0,r.jsx)(I,{text:"Login",styles:q().registerBtn,callback:()=>{let r=s.tryReadFromStorage(a);P.loginUser({name:i,pwd:c},r).then(r=>{l(""),u(""),t(r.user),s.storeItem(o,r.sessionId),e.onLogin(r.user.name)}).catch(t=>e.onError(O.ERR,W(t).msg))}}),(0,r.jsx)(I,{text:"Register",styles:q().registerBtn,callback:d})]})})}function Y(e){e.preventDefault()}var Z=s(7014),ee=s.n(Z);function et(e){let[t,s]=(0,n.useState)(""),[o,a]=(0,n.useState)(O.NONE),{addUser:i}=(0,n.useContext)(v);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)($,{msg:t,type:o}),(0,r.jsx)(K,{...e,onRegister:e=>{s("Registration was successful"),a(O.INFO),i(e)},onLogin:e.onLogin,onError:(e,t)=>{s(t),a(e)},styles:ee().LoginForm})]})}var es=s(3774),er=s.n(es);function en(e){let{setActiveView:t}=(0,n.useContext)(f);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T,{showLogo:!1,styles:{headerStripes:er().headerStripes,title:er().title}}),(0,r.jsx)(D,{styles:er().logo}),(0,r.jsx)(et,{onLogin:s=>{t(j.Playground),e.onLogin(s)}})]})}var eo=s(4622),ea=s.n(eo);function ei(e){let{appHeight:t}=(0,n.useContext)(eW);return(0,r.jsx)("div",{className:ea().Modal,style:{height:t},children:e.children})}var el=s(9458),ec=s.n(el);function eu(e){return(0,r.jsxs)("tr",{className:ec().itemContent,children:[(0,r.jsx)("td",{children:(0,r.jsx)("div",{className:ec().userData,children:e.user.name})}),(0,r.jsx)("td",{className:ec().count,children:e.user.beerCount}),(0,r.jsx)("td",{className:ec().count,children:e.user.shotCount}),(0,r.jsx)("td",{className:ec().count,children:e.user.otherCount}),(0,r.jsx)("td",{className:ec().count,children:e.user.waterCount}),(0,r.jsx)("td",{className:ec().count,children:e.user.cigaretteCount}),e.isEditable?(0,r.jsx)("td",{children:(0,r.jsx)("button",{className:ec().delBtn,onClick:e.deleteGotClicked,children:"❌"})}):null]})}var ed=s(3911),eg=s.n(ed);function eh(e){return(0,r.jsx)("div",{className:eg().TableArea,children:(0,r.jsxs)("table",{className:eg().UserList,children:[(0,r.jsx)("thead",{className:eg().Thead,children:(0,r.jsxs)("tr",{className:eg().Tr,children:[(0,r.jsx)("th",{className:eg().Th}),(0,r.jsx)("th",{className:eg().Th,children:"\uD83C\uDF7A"}),(0,r.jsx)("th",{className:eg().Th,children:"\uD83E\uDD43"}),(0,r.jsx)("th",{className:eg().Th,children:"\uD83E\uDD64"}),(0,r.jsx)("th",{className:eg().Th,children:"\uD83D\uDEB0"}),(0,r.jsx)("th",{className:eg().Th,children:"\uD83D\uDEAC"})]})}),(0,r.jsx)("tbody",{children:e.users.map((t,s)=>(0,r.jsx)(eu,{id:`${t.name}-${s}`,user:t,isEditable:e.isEditable,deleteGotClicked:()=>e.onDelete?e.onDelete(t.id):null},`${t.name}-${s}`))})]})})}var em=s(2263),ex=s.n(em);function e_(e){let t=async t=>{let s=d(await c(i.GET,`${t}/${e.user.id}`,"",e.userSession));e.onUserUpdate(s)};return(0,r.jsxs)("div",{className:ex().User,children:[(0,r.jsx)("p",{className:ex().name,children:e.user.name}),(0,r.jsxs)("div",{className:ex().statsPanel,children:[(0,r.jsxs)("div",{className:ex().icons,children:[(0,r.jsx)("button",{onClick:()=>t("beer"),className:ex().beer,children:"\uD83C\uDF7A"}),(0,r.jsx)("button",{onClick:()=>t("shot"),className:ex().shots,children:"\uD83E\uDD43"}),(0,r.jsx)("button",{onClick:()=>t("other"),className:ex().other,children:"\uD83E\uDD64"}),(0,r.jsx)("button",{onClick:()=>t("water"),className:ex().water,children:"\uD83D\uDEB0"}),(0,r.jsx)("button",{onClick:()=>t("cigarette"),className:ex().cigarette,children:"\uD83D\uDEAC"})]}),(0,r.jsxs)("div",{className:ex().stats,children:[(0,r.jsx)("p",{className:ex().count,children:e.user.beerCount}),(0,r.jsx)("p",{className:ex().count,children:e.user.shotCount}),(0,r.jsx)("p",{className:ex().count,children:e.user.otherCount}),(0,r.jsx)("p",{className:ex().count,children:e.user.waterCount}),(0,r.jsx)("p",{className:ex().count,children:e.user.cigaretteCount})]})]})]})}var ey=s(2091),ep=s.n(ey);function ej(e){let t=async()=>{let t=d(await c(i.GET,`water/${e.userId}`,"",e.userSession));e.onWaterConsumed(t)};return(0,r.jsxs)("div",{className:ep().warningWrapper,children:[(0,r.jsx)("p",{className:ep().warning,children:"Du musst eine Wasserrunde trinken"}),(0,r.jsx)(I,{text:"Wasser getrunken",styles:"",callback:t})]})}class eC{constructor(e){this.id=e.id,this.name=e.name,this.role=e.role,this.pwd=e.pwd,this.beerCount=e.beerCount,this.shotCount=e.shotCount,this.otherCount=e.otherCount,this.waterCount=e.waterCount,this.cigaretteCount=e.cigaretteCount}}var eL=s(4840),ew=s.n(eL);function ev(e){let{keyValueStore:t}=(0,n.useContext)(w),s=t.tryReadFromStorage(o),a=new eC(e.user);return(0,r.jsxs)(r.Fragment,{children:[function(e){let t=e.beerCount+e.shotCount;return!(t<3)&&t>3*e.waterCount+3}(a)&&(0,r.jsx)(ei,{children:(0,r.jsx)(ej,{userId:e.user.id,onWaterConsumed:e.onUserUpdate,userSession:s})}),(0,r.jsxs)("div",{className:ew().Playground,children:[(0,r.jsx)(T,{showLogo:!0}),(0,r.jsx)(e_,{user:e.user,onUserUpdate:e.onUserUpdate,userSession:s}),(0,r.jsx)(eh,{users:e.users,isEditable:!1}),(0,r.jsxs)("div",{className:ew().buttons,children:[(0,r.jsx)(I,{text:"logout",styles:ew().Btn,callback:e.logout}),(0,r.jsx)(I,{text:"\uD83D\uDD04",styles:ew().refresh,callback:e.onRefresh})]}),(0,r.jsx)(I,{text:"archive",styles:ew().Btn,callback:e.onHistories}),(0,r.jsx)(I,{text:"admin",styles:ew().Btn,callback:e.openAdminLogin})]})]})}var ef=s(7737),eS=s.n(ef);async function eb(e){return c(i.GET,"historize","",e)}async function eN(e){return c(i.GET,"histories","",e)}async function eE(e,t){return c(i.POST,"history",t,e)}function eD(e){let{setActiveView:t}=(0,n.useContext)(f),{keyValueStore:s}=(0,n.useContext)(w),[a,l]=(0,n.useState)(""),[u,g]=(0,n.useState)({msgType:O.NONE,msg:""}),h=async()=>{let t=s.tryReadFromStorage(o),r=d(await eb(t));g({msgType:O.INFO,msg:`saved ${r.length} history entries`}),e.updateUsersOnHistorize()},m=async()=>{let e=s.tryReadFromStorage(o),t=await eE(e,a);try{let e=d(t);g({msgType:O.INFO,msg:`stored history with ${e.length} items`}),l("")}catch(e){g({msgType:O.ERR,msg:W(e).msg})}};return(0,r.jsxs)("div",{className:eS().AdminConsole,children:[(0,r.jsx)(T,{showLogo:!0}),(0,r.jsxs)("div",{className:eS().DataSection,children:[(0,r.jsx)(eh,{users:e.users,isEditable:!0,onDelete:t=>{let r=s.tryReadFromStorage(o),n=c(i.DELETE,`delete/${t}`,"",r);e.onDelete(n)}}),(0,r.jsx)(I,{text:"historize",styles:eS().Btn,callback:h}),(0,r.jsx)(I,{text:"Home",styles:eS().Btn,callback:()=>t(j.Playground)}),(0,r.jsx)($,{msg:u.msg,type:u.msgType}),(0,r.jsx)("textarea",{className:eS().textarea,placeholder:"paste history as CSV here",onChange:e=>l(e.target.value)}),(0,r.jsx)(I,{text:"save history",styles:eS().Btn,callback:m})]})]})}function eA(e){let t=new Date(1e3*e.secs_since_epoch);return{date:t.toLocaleDateString(),time:t.toLocaleTimeString()}}var ek=s(7768),eT=s.n(ek);function eU(e){let{setActiveView:t}=(0,n.useContext)(f),{date:s,time:o}=e.dateAndTime;return(0,r.jsxs)("div",{className:eT().OneHistory,children:[(0,r.jsx)(T,{showLogo:!0}),(0,r.jsx)("h1",{className:eT().H1,children:"Historisches Ergebnis"}),(0,r.jsx)("h2",{className:eT().H2,children:`${s} / ${o}`}),(0,r.jsx)(eh,{users:e.users,isEditable:!1}),(0,r.jsx)(I,{text:"back",styles:eT().Btn,callback:()=>t(j.Histories)}),(0,r.jsx)(I,{text:"Home",styles:eT().Btn,callback:()=>t(j.Playground)})]})}var eF=s(2564),eR=s.n(eF);function eH(e){let{setActiveView:t}=(0,n.useContext)(f),{setSelectedHistory:s}=(0,n.useContext)(b);return(0,r.jsxs)("div",{className:eR().ArchiveView,children:[(0,r.jsx)(T,{showLogo:!0}),(0,r.jsx)("ol",{className:eR().ArchiveList,children:Array.from(e.historyDays.keys()).map((n,o)=>{let{date:a,time:i}=JSON.parse(n);return(0,r.jsx)("li",{id:`history-${o}`,children:(0,r.jsx)(I,{styles:eR().archiveButton,text:`Beendet am ${a} um ${i}`,callback:()=>{s(e.historyDays.get(n)||[]),t(j.OneHistory)}})},`history-${o}`)})}),(0,r.jsx)(I,{styles:"",text:"home",callback:()=>t(j.Playground)})]})}function eO(e){let[t,s]=(0,n.useState)([]),[i,l]=(0,n.useState)(null),[c,u]=(0,n.useState)([]),[g,y]=(0,n.useState)([]),{setAdminLoginOpen:C}=(0,n.useContext)(eW),{activeView:L,setActiveView:N}=(0,n.useContext)(f),{setCurrentError:E}=(0,n.useContext)(S),{keyValueStore:D}=(0,n.useContext)(w),A=async()=>{try{console.log("trying to fetch all users");let e=D.readFromStorage(o);if(e){let t=await m(e),r=d(t);s(r)}}catch(e){N(j.ClubLogin),console.error(`Loading users failed: ${e}`),E("loading users failed"+W(e).msg)}};(0,n.useEffect)(()=>{L===j.Playground&&A()},[L]);let k=async e=>{e&&(console.log("Checking if club-token is still valid"),!0===await P.hasClubAccess(e)?(console.log("Has club access"),N(j.UserLogin)):(console.log("Club token is not valid, removing club-token"),D.removeItem(a),N(j.ClubLogin)))};(0,n.useEffect)(()=>{let t=async t=>{console.log("trying to attach session");let s=await x(t);if(s.Err){console.log(`Session login did not work. Err: ${s.Err}. Clearing token`),D.removeItem(o);let e=D.readFromStorage(a);e&&k(e)}else{console.log(`got attachResponse: ${JSON.stringify(s)}`);let t=d(s);l(t),e.onUserLogin(t.name),N(j.Playground),A()}},s=D.readFromStorage(o);s&&t(s).catch(e=>{console.error(`Could not attach session: ${e}`),E("Attaching session failed")})},[]);let T=async e=>{d(await e),A()},U=async()=>{let e=D.tryReadFromStorage(o);await _(e)&&(N(j.UserLogin),l(null),D.removeItem(o))},F=async()=>{let e=D.tryReadFromStorage(o);s(d(await m(e))),i&&(console.log(`update sessionUser: ${i.name}`),l(d(await h(e,i.name))))},R=async()=>{let e=D.tryReadFromStorage(o);u(d(await eN(e))),N(j.Histories)};return(0,r.jsx)("div",{className:p().Main,children:(0,r.jsxs)(v.Provider,{value:{addUser:e=>{s([...t,e])},setSessionUser:l},children:[L===j.ClubLogin&&(0,r.jsx)(Q,{}),L===j.UserLogin&&(0,r.jsx)(en,{onLogin:e.onUserLogin}),L===j.Playground&&i&&(0,r.jsx)(ev,{user:i,users:t,logout:U,openAdminLogin:()=>{C(!0)},onUserUpdate:e=>{s(t.map(t=>t.id===e.id?e:t)),l(e)},onHistories:R,onRefresh:F}),L===j.AdminConsole&&(0,r.jsx)(eD,{users:t,onDelete:T,updateUsersOnHistorize:F}),(0,r.jsxs)(b.Provider,{value:{selectedHistory:g,setSelectedHistory:y},children:[L===j.Histories&&(0,r.jsx)(eH,{historyDays:c.reduce((e,t)=>{let s=JSON.stringify(eA(t.timestamp)),r=e.get(s);return r?r.push(t):e.set(s,[t]),e},new Map)}),L===j.OneHistory&&(0,r.jsx)(eU,{dateAndTime:eA(g[0].timestamp),users:g.map(e=>({id:e.id,name:e.userName,role:null,pwd:"",beerCount:e.beerCount,shotCount:e.shotCount,otherCount:e.otherCount,waterCount:e.waterCount,cigaretteCount:e.cigaretteCount}))})]})]})})}s(3905);var e$=s(2711),eP=s.n(e$);function eV(){let{currentError:e}=(0,n.useContext)(S);return(0,r.jsx)("div",{className:eP().error,children:(0,r.jsx)("p",{children:e})})}var eB=s(4909),eI=s.n(eB);function eM(e){let[t,s]=(0,n.useState)(""),{keyValueStore:i}=(0,n.useContext)(w),l=async()=>{console.log("calling login");let r=await P.loginUser({name:e.userName,pwd:t},i.tryReadFromStorage(a));console.log("got a fresh token"),s(""),i.storeItem(o,r.sessionId),!0===await P.isAdmin(r.sessionId)?(console.log("Admin-Login succeeded"),e.onLogin(j.AdminConsole)):console.log(`user ${e.userName} is no admin`)};return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("form",{onSubmit:eG,className:`${eI().RegisterLoginForm}`,children:[(0,r.jsx)("input",{type:"password",value:t,placeholder:"password",onChange:e=>s(e.target.value)}),(0,r.jsx)(I,{text:"Login",styles:eI().registerBtn,callback:()=>l().catch(t=>e.onError(O.ERR,W(t).msg))})]})})}function eG(e){e.preventDefault()}let eW=n.createContext({isAdminLoginOpen:!1,setAdminLoginOpen:e=>{},appHeight:0}),ez=function(){let[e,t]=(0,n.useState)(window.innerHeight),[s,o]=(0,n.useState)(j.ClubLogin),[a,i]=(0,n.useState)(""),[l,c]=(0,n.useState)(""),[u,d]=(0,n.useState)(!1);return(0,r.jsx)(eW.Provider,{value:{isAdminLoginOpen:u,setAdminLoginOpen:d,appHeight:e},children:(0,r.jsx)(S.Provider,{value:{currentError:a,setCurrentError:i},children:(0,r.jsx)(f.Provider,{value:{activeView:s,setActiveView:o},children:(0,r.jsxs)("div",{className:"App",style:{height:e},children:[(0,r.jsx)(eO,{onUserLogin:c}),u&&(0,r.jsx)(ei,{children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eM,{onLogin:e=>{o(e),d(!1)},onError:e=>i(`Admin Login failed: ${W(e).msg}`),userName:l}),(0,r.jsx)(I,{text:"cancel",callback:()=>{d(!1),i("")},styles:""})]})}),(0,r.jsx)(eV,{})]})})})})}}}]);